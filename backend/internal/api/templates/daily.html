{{define "content"}}
<div class="container">
  <div class="hero">
    <h1>Your Daily Read</h1>
    <p>{{.Date}} â€” Top unread articles curated for you</p>
  </div>
  
  {{if .Articles}}
  <div class="articles">
    {{range .Articles}}
    <article class="article-card" data-id="{{.ID}}">
      <h2><a href="/read/{{.ID}}">{{.Title}}</a></h2>
      {{if .Summary}}
      <p class="summary">{{.Summary}}</p>
      {{end}}
      <div class="article-meta">
        <span class="source">{{if .FeedName}}{{.FeedName}}{{else}}Unknown{{end}}</span>
        <span class="reading-time">{{.ReadingTime}} min read</span>
        {{if .QualityRank}}
        <span class="score{{if ge .QualityRank 80}} high{{else if ge .QualityRank 60}} mid{{end}}">{{.QualityRank}}</span>
        {{end}}
      </div>
      {{if .Tags}}
      <div class="tags">
        {{range .Tags}}
        <span class="tag">{{.}}</span>
        {{end}}
      </div>
      {{end}}
      <div class="article-actions">
        <button class="action-btn" onclick="markRead({{.ID}})" title="Mark as read">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20 6L9 17l-5-5"/>
          </svg>
          Done
        </button>
        <button class="action-btn {{if .ReadLater}}saved{{end}}" onclick="toggleSave({{.ID}})" title="Save forever">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="{{if .ReadLater}}currentColor{{else}}none{{end}}" stroke="currentColor" stroke-width="2">
            <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/>
          </svg>
          Save
        </button>
      </div>
    </article>
    {{end}}
  </div>
  {{else}}
  <div class="empty-state">
    <p>No unread articles. Check back later or add more feeds!</p>
    <a href="/feeds" class="btn btn-primary">Add Feeds</a>
  </div>
  {{end}}
</div>

<script>
function markRead(id) {
  fetch('/api/articles/' + id + '/read', { method: 'POST' })
    .then(function(res) {
      if (res.ok) {
        var el = document.querySelector('[data-id="' + id + '"]');
        if (el) {
          el.style.opacity = '0.5';
          setTimeout(function() { el.remove(); }, 300);
        }
      }
    });
}

function toggleSave(id) {
  fetch('/api/articles/' + id + '/save', { method: 'POST' })
    .then(function(res) { return res.json(); })
    .then(function(data) {
      var btn = document.querySelector('[data-id="' + id + '"] .action-btn:nth-child(2)');
      if (btn) {
        if (data.data.saved) {
          btn.classList.add('saved');
          btn.querySelector('svg').setAttribute('fill', 'currentColor');
        } else {
          btn.classList.remove('saved');
          btn.querySelector('svg').setAttribute('fill', 'none');
        }
      }
    });
}
</script>
{{end}}
